<div class="container create-operation">
  <div class="row">

    <div class="pt-5 col-8"
      *ngIf="rw.reportingWindow"
      [ngClass]="{'processing': processing || rw.processing}">
      <h1 *ngIf="rw.reportingWindow.value && rw.reportingWindow.value.name && rw.reportingWindow.value.name !== ''; else defaultReportingWindowName">
        {{ rw.reportingWindow.value.name }}
      </h1>
      <ng-template #defaultReportingWindowName><h1 translate>New ReportingWindow</h1></ng-template>

      <div>
        <small class="text-secondary" *ngIf="rw.reportingWindow.created">
          Created by {{ rw.reportingWindow.created.participant.name_given }}
          {{ rw.reportingWindow.created.participant.name_family }} on {{ rw.reportingWindow.created.createdAt | date: 'yyyy-MM-d HH:mm:ss' }}.
        </small>
      </div>

      <div>
        <small class="text-secondary" *ngIf="rw.reportingWindow.lastUpdated">
          Last updated by {{ rw.reportingWindow.lastUpdated.participant.name_given }}
          {{ rw.reportingWindow.lastUpdated.participant.name_family }} on {{ rw.reportingWindow.lastUpdated.updatedAt | date: 'yyyy-MM-d HH:mm:ss' }}.
        </small>
      </div>

      <router-outlet (activate)='onActivate($event)'></router-outlet>

      <nav class="navbar bg-light fixed-bottom"
        *ngIf="rw.editMode">
        <div class="container d-flex justify-content-end">
          <form class="form-inline">
            <a type="button"
              class="mr-2 btn btn-outline-secondary"
              [routerLink]="['/reporting-window']"
              [queryParams]="{source: 'reportingWindow'}"
              translate>
              {{ 'Close' | translate }}
            </a>
            <button *ngIf="currentStepIdx > 0"
              type="button"
              class="mr-2 btn btn-outline-primary"
              (click)="goToPreviousStep(currentChildRoute && currentChildRoute !== 'workflow')"
              translate>
              {{ 'Previous' | translate }} <i class="material-icons">arrow_back</i>
            </button>
            <button
              *ngIf="editable"
              type="button"
              class="mr-2 btn btn-outline-primary"
              (click)="save()"
              translate>
              Save
            </button>
            <button
              *ngIf="editable && currentChildRoute !== 'workflow'"
              type="button"
              class="btn btn-primary"
              (click)="save('next')">
              {{ 'Save & Next' | translate }} <i class="material-icons">arrow_forward</i>
            </button>
          </form>
        </div>
      </nav>
    </div>
  </div>
</div>
<span [ngClass]="{'data-load-finished': rw.reportingWindow && !processing && !rw.processing}"></span>
