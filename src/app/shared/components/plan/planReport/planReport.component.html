<div class="container reports" *ngIf="plan">
  <div class="row summary">
    <div class="col-lg-12">
      <h1>{{ plan.name }}</h1>

      <div class="statistics">
        <app-header-statistic
          label="Start Date"
          [value]="plan.startDate | date:'dd/MM/yyyy'">
        </app-header-statistic>
        <app-header-statistic
          label="End Date"
          [value]="plan.endDate | date: 'dd/MM/yyyy'">
        </app-header-statistic>
        <app-header-statistic
          label="Projects"
          [value]="plan.projectCount">
        </app-header-statistic>
        <app-header-statistic
          label="Original requirements"
          [value]="plan.sumOrigReqFunds | currency:'USD':'symbol':'1.0-0'">
        </app-header-statistic>
        <app-header-statistic
          label="Revised requirements"
          [value]="plan.sumCurrReqFunds | currency:'USD':'symbol':'1.0-0'">
        </app-header-statistic>
      </div>
    </div>
  </div>
  <div class="row breakdown-header">
    <h2 class="col-lg-5">
      Summary of Projects
    </h2>
    <span class="report-controls col-lg-7">
      Group By:
      <select class="form-control"
        [(ngModel)]="groupBySelected"
        (change)="updateGroupBy()">
        <option *ngFor="let group of groupBy"
          value="{{group.key}}">{{ group.name }}
        </option>
      </select>

      <app-filter-options-modal
        [filtersByField]="filtersByField"
        [filterByStatus]="filterByStatus"
        (onStatusesUpdate)="updateStatuses($event)"
        [dataUpdatedObservable$]="dataUpdatedObservable$"
        [filterOnFields]="getFilterOnFields()"
        >
      </app-filter-options-modal>

      <button
        class="btn btn-outline-primary export"
        (click)="projectTable.exportData()">
        <i class="fa fa-download"></i>
        Export
      </button>
    </span>
  </div>
  <div class="row breakdown">
    <div class="col-lg-12">
      <app-report-project-table
        #projectTable
        [searchOptions]="searchOptions"
        [groupBy]="groupBySelected"
        [filterByFields]="filterSelectedFields"
        [filterByStatus]="filterSelectedStatusArray"
        [dataUpdated]="dataUpdatedObservable$"
        [planId]="id"
        [planName]="plan.name">
      </app-report-project-table>
    </div>
  </div>
</div>

